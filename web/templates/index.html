<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Plex DB</title>
    <link rel="stylesheet" type="text/css"
          href="{{ static_url('bower_components/bootstrap/dist/css/bootstrap.min.css') }}">
    <link rel="stylesheet" type="text/css"
          href="{{ static_url('bower_components/datatables/media/css/dataTables.bootstrap.min.css') }}">
    <link rel="stylesheet" type="text/css"
          href="{{ static_url('style.css') }}">
</head>
<body>
<nav class="nav navbar-inverse">
    <div class="container-fluid">
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li id='watched' class="active">
                    <a onclick="loadWatched()" href="#">Watched</a>
                </li>
                <li id='unwatched'>
                    <a onclick="loadUnwatched()" href="#">Unwatched</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="data">
    <div id='watched_data'>
        <table id='watched_table' class="table table-condensed">
            <thead>
            <tr>
                <th>Account</th>
                <th>Title</th>
                <th>Views</th>
            </tr>
            </thead>
        </table>
    </div>

    <div id='unwatched_data' class="hidden">
        <table id="unwatched_table" class="table table-condensed">
            <thead>
            <tr>
                <th>Parent Name</th>
                <th>Title</th>
                <th>Type</th>
            </tr>
            </thead>
        </table>
    </div>
</div>

<footer>
    <script type="text/javascript"
            src="{{ static_url('bower_components/jquery/dist/jquery.min.js') }}"></script>
    <script type="text/javascript"
            src="{{ static_url('bower_components/bootstrap/dist/js/bootstrap.min.js') }}"></script>
    <script type="text/javascript"
            src="{{ static_url('bower_components/datatables/media/js/jquery.dataTables.min.js') }}"></script>
    <script type="text/javascript"
            src="{{ static_url('bower_components/datatables/media/js/dataTables.bootstrap.min.js') }}"></script>
    <script>
        function toggle_tables() {
            var unwatched_table = $('#unwatched_data');
            var watched_table = $('#watched_data');

            if (unwatched_table.hasClass('hidden')) {
                unwatched_table.removeClass('hidden');
            } else {
                unwatched_table.addClass('hidden');
            }

            if (watched_table.hasClass('hidden')) {
                watched_table.removeClass('hidden');
            } else {
                watched_table.addClass('hidden');
            }
        }

        function loadWatched() {
            var datatable = $('#watched_table').dataTable().api();
            toggle_tables();
            datatable.ajax.url('/api/watched').load();
        }

        function loadUnwatched() {
            var datatable = $('#unwatched_table').dataTable().api();
            toggle_tables();
            datatable.ajax.url('/api/unwatched').load();
        }

        $('.nav li').click(function (e) {
            $('.nav li.active').removeClass('active');
            var me = $(this);
            if (!me.hasClass('active')) {
                me.addClass('active');
            }
        });

        $('#watched_table').DataTable({
            ajax: {
                url: '/api/watched',
                dataSrc: '',
                type: 'GET'
            },
            autoWidth: false,
            lengthMenu: [10, 15, 20, 25, 50, 75, 100],
            columns: [
                {data: 'name'},
                {data: 'title'},
                {data: 'view_count'}
            ]
        });

        $('#unwatched_table').DataTable({
            ajax: {
                url: '/api/empty',
                dataSrc: '',
                type: 'GET'
            },
            autoWidth: false,
            lengthMenu: [10, 15, 20, 25, 50, 75, 100],
            columns: [
                {data: 'parent_name'},
                {data: 'title'},
                {data: 'show_type'}
            ]
        });
    </script>
</footer>
</body>
</html>